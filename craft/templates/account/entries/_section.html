{% requireLogin %}

{% set statuses = ['live', 'disabled'] %}

{% set entries = craft.entries.section(section).status(statuses).authorId(currentUser.id).order('dateCreated desc') %}

{% extends "_common/layout" %}

{% block main %}
  {% embed "account/_layout" %}
    {% block post %}
      <h2 class="comment-count">{{ title }}</h2>

      <table>
        <tr>
          <th>Title</th>
          <th>Created</th>
          <th>Published</th>
          <th></th>
          <th></th>
          <th></th>
          <th></th>
        </th>
        {% for entry in entries %}
          <tr>
            <td>{{ entry.title }}</td>
            <td>{{ entry.dateCreated | date('M d, Y') }}</td>
            <td>
              {% if entry.status != 'disabled' %}
                {{ entry.postDate | date('M d, Y') }}
              {% endif %}
            </td>
            <td><a href="/view/{{ entry.id }}/{{ entry.slug }}">View</a></td>
            <td>
              {% if currentUser.isInGroup('contributor') or entry.status == 'disabled' %}
                <a href="/edit/{{ entry.id }}/{{ entry.slug }}">Edit</a>
              {% endif %}
            </td>
            <td>
              {% if currentUser.isInGroup('contributor') and entry.status == 'live' %}
                <a href="{{ actionUrl('mpEntry/unpublishEntry', { entryId: entry.id }) }}">Unpublish</a>
              {% endif %}
            </td>
            <td>
              <a href="{{ actionUrl('mpEntry/deleteEntry', { entryId: entry.id }) }}">Delete</a>
            </td>
          </tr>
        {% endfor %}
      </table>
    {% endblock %}
  {% endembed %}
{% endblock %}
