{% requireLogin %}

{% extends "_layout" %}

{% block content %}
  {% embed "_unfiltered_content.html" %}
    {% from "_submit.html" import actionUrl, redirectTo %}
    {% from "_macro.html" import errorList %}

    {% block main %}
      <form method="post" accept-charset="UTF-8" enctype="multipart/form-data" class="content-submission">
        {{ getCsrfInput() }}
        <input type="hidden" name="action" value="{{ actionUrl() }}">
        <input type="hidden" name="redirect" value="{{ redirectTo('blog') }}">
        <input type="hidden" name="sectionId" value="3">
        <input type="hidden" name="enabled" value="1">

        {% if entry is defined %}
          {{ errorList(entry.getAllErrors) }}
        {% endif %}
        <br>

        {% include "submit/_title.html" %}
        {% include "submit/_location.html" %}
        {% include "submit/_topic.html" %}

        <label for="mainContent">Main Content</label>
        <textarea id="mainContent" name="fields[mainContent]" cols="60" rows="8" class="required"> {%- if entry is defined %}{{ entry.mainContent }}{% endif -%} </textarea>
        {# includeJsResource "lib/redactor/redactor.js" #}
        {# includeCssResource "lib/redactor/redactor.css" #}
        {# includeJs "$('#mainContent').redactor();" #}
        {% if entry is defined %}
          {{ errorList(entry.getErrors('mainContent')) }}
        {% endif %}
        <br>
  
        <label for="primaryImage">Primary Image</label>
        <input id="primaryImage" type="file" name="fields[primaryImage]">
        {% if entry is defined %}
            {{ errorList(entry.getErrors('primaryImage')) }}
        {% endif %}
        <br>
  
        <label for="secondaryImages">Secondary Images (max: 3)</label>
        <input id="secondaryImages" type="file" name="fields[secondaryImages][]" multiple>
        {% if entry is defined %}
            {{ errorList(entry.getErrors('secondaryImages')) }}
        {% endif %}
        <br>

        <input type="submit" value="Submit Blog Post">
      </form>
    {% endblock %}
  {% endembed %}
{% endblock %}
