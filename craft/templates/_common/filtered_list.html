<main>
  <div class="sub-nav">
    {% block subNav %}
      <div class="filter" id="filters">
<!--         <a href="#"><h3>Save My Settings</h3></a> -->
        <fieldset class="locations">
          <h5>Location</h5>
          <ul>
            <li><input type="checkbox" class="location all" id="location-all" value="all" checked="checked" /><label for="location-all">All</label></li>

            {% set group = null %}
            {% for location in craft.categories.group('locations') %}
              {% if location.geographicGroup != group %}
                {% set group = location.geographicGroup %}
                <li class="group-label">{{ group.label }}</li>
              {% endif %}
              <li><input type="checkbox" class="location filter" id="{{ location.id }}" value="{{ location.id }}"/><label for="{{ location.id }}">{{ location.title }}</label></li>
            {% endfor %}
          </ul>
        </fieldset>

        <fieldset class="topics">
          <h5>Topics</h5>
          <ul>
            <li><input type="checkbox" class="topic all" value="all" checked="checked" />All</li>

            {% for topic in craft.categories.group('topics') %}
              <li><input type="checkbox" class="topic filter" id="{{ topic.id }}" value="{{ topic.id }}"/><label for="{{ topic.id }}">{{ topic.title }}</label></li>
            {% endfor %}
          </ul>
        </fieldset>

        <fieldset class="authors">
          <h5>Contributors</h5>
          <ul>
            <li><input type="checkbox" class="author all" value="all" checked="checked" />All</li>

            {% for author in craft.users.group('contributor').order('lastName, firstName') %}
              <li><input type="checkbox" class="author filter" id="{{ author.id }}" value="{{ author.id }}"/><label for="{{ author.id }}">{{ author.name }}</label></li>
            {% endfor %}
          </ul>
        </fieldset>
      </div>
    {% endblock %}
  </div>

  <div class="list-wrapper">
    <h2>
      {% block h2 %}
      {% endblock %}
    </h2>
  
    <ul class="posts">
      {% block posts %}
      {% endblock %}
    </ul>
  </div>
</main>

{% set filter = craft.request.query('filter') %}
{% set id = craft.request.query('id') %}

{% set js %}
  $(function() {
    var filter = '{{ filter }}';
    var id = '{{ id }}';
    var fieldset;

    $('ul.posts').filters();

    if (filter.length > 0 && id.length > 0) {
      fieldset = $('#filters fieldset.'+filter);
      fieldset.find('h5').click();
      fieldset.find('li > input[value='+id+']').click();
    }
  });
{% endset %}

{% includeJs js %}

{% include "_common/disqus_count.html" %}
